CMAKE_MINIMUM_REQUIRED(VERSION 2.6)

PROJECT (spacegameengine)

SET(CMAKE_MODULE_PATH "${CMAKE_SOURCE_DIR}/CMakeModules;${CMAKE_MODULE_PATH}")

INCLUDE(FcpptCMakeUtils)

# Put libraries and exe files in the same directory
# because Windows lacks 'rpath'
IF(MSVC)
	SET(LIBRARY_OUTPUT_PATH ${EXECUTABLE_OUTPUT_PATH})
ENDIF()

INCLUDE_DIRECTORIES (${CMAKE_SOURCE_DIR}/include)

FIND_PACKAGE(
	Boost 1.47.0 REQUIRED
)

INCLUDE_DIRECTORIES(${Boost_INCLUDE_DIR})

LINK_DIRECTORIES(${Boost_LIBRARY_DIRS})

IF(
	MSVC AND ${Boost_VERSION} STREQUAL "104800"
)
	ADD_DEFINITIONS(
		-D BOOST_FUSION_DONT_USE_PREPROCESSED_FILES
	)
ENDIF()


# FIND FCPPT
FIND_PACKAGE(Fcppt REQUIRED)

ADD_DEFINITIONS(${Fcppt_DEFINITIONS})

INCLUDE_DIRECTORIES(${Fcppt_INCLUDE_DIRS})

# FIND MIZUIRO
FIND_PACKAGE(Mizuiro REQUIRED)

INCLUDE_DIRECTORIES(
	${Mizuiro_INCLUDE_DIRS}
)

# FIND AWL
FIND_PACKAGE(
	Awl
	REQUIRED
)

INCLUDE_DIRECTORIES(
	${Awl_INCLUDE_DIRS}
)

# TODO: Check if this is needed (or move it to fcppt/awl)
IF(MSVC)
	ADD_DEFINITIONS(-DUNICODE=1 -D_UNICODE=1)
ENDIF()

SET(
	MEDIA_INSTALL_DIR
	"${INSTALL_DATA_DIR}/media"
)

SET(
	INSTALL_PLUGIN_DIR_BASE
	"${INSTALL_LIBRARY_DIR}"
	CACHE
	STRING
	"Custom plugin base installation directory"
)

SET(
	PLUGIN_INSTALL_DIR
	"${INSTALL_PLUGIN_DIR_BASE}/${CMAKE_PROJECT_NAME}"
)

ADD_SUBDIRECTORY (src)

OPTION(ENABLE_DOC "Build the documentation" OFF)

IF(ENABLE_DOC)
	ADD_SUBDIRECTORY(doc)
ENDIF()

OPTION(ENABLE_EXAMPLES "Build the examples" OFF)

IF(ENABLE_EXAMPLES)
	ADD_SUBDIRECTORY (examples)
ENDIF ()

OPTION(ENABLE_TEST "Build the tests" OFF)

IF(ENABLE_TEST)
	ENABLE_TESTING()
	ADD_SUBDIRECTORY (tests)
ENDIF ()

INSTALL(
	DIRECTORY
	media/
	DESTINATION
	${MEDIA_INSTALL_DIR}
)

INSTALL(
	FILES
	${CMAKE_SOURCE_DIR}/CMakeModules/FindSGE.cmake
	${CMAKE_SOURCE_DIR}/CMakeModules/FindCEGUI.cmake
	${CMAKE_SOURCE_DIR}/CMakeModules/SGECustomPath.cmake
	DESTINATION
	${INSTALL_CMAKEMODULES_DIR}
)
